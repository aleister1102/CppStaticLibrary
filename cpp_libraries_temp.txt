/**
 * It converts a date object to a string
 *
 * @param date The date to convert to a string
 *
 * @return A string
 */
std::string Converter::toString(Date date)
{
	std::stringstream builder;

	if (date.isValid())
	{
		if (date.getDay() < 10 && date.getDay() > 0)
			builder << "0";
		builder << date.getDay() << "/";
		if (date.getMonth() < 10 && date.getMonth() > 0)
			builder << "0";
		builder << date.getMonth() << "/" << date.getYear();
	}
	else
	{
		builder << "Can not convert to string, date is invalid";
	}

	std::string result = builder.str();
	return result;
}

/**
 * This function converts a fraction to a string
 *
 * @param fraction The fraction to convert to a string.
 *
 * @return A string
 */
std::string Converter::toString(Fraction fraction)
{
	std::stringstream builder;
	if (fraction.isValid())
	{
		builder << fraction.Numerator() << "/" << fraction.Denominator();
	}
	else
	{
		builder << "Can not convert to string, fraction is invalid";
	}

	std::string result = builder.str();
	return result;
}

/**
 * It takes a string, tries to parse it as a date, and returns a Date object
 *
 * @param str The string to parse
 *
 * @return A shared pointer to a Date object.
 */
Date Converter::parseDate(const std::string str)
{
	State flags;
	std::string date;
	std::shared_ptr<Date> result = nullptr;

	tie(flags, date) = tryParse(str, std::regex(DATE));
	if (!flags.Successful())
	{
		std::cout << "Can not parse date!\n";
		std::cout << "Error code: " << flags.ErrorCode() << std::endl;
		std::cout << "Message: " << flags.Message() << std::endl;
	}
	else
	{
		auto tokens = StringHelper::split(date, "/");
		result = std::make_shared<Date>(parseInt(tokens[0]), parseInt(tokens[1]), parseInt(tokens[2]));
		if (!result->isValid())
			std::cout << "Invalid date!\n";
	}

	return *result;
}

/**
 * It takes a string, tries to parse it as a fraction, and returns a Fraction object
 *
 * @param str The string to be parsed.
 *
 * @return A fraction object.
 */
Fraction Converter::parseFraction(const std::string str)
{
	State flags;
	std::string fraction;
	std::shared_ptr<Fraction> result = nullptr;

	tie(flags, fraction) = tryParse(str, std::regex(FRACTION));
	if (!flags.Successful())
	{
		std::cout << "Can not parse fraction!\n";
		std::cout << "Error code: " << flags.ErrorCode() << std::endl;
		std::cout << "Message: " << flags.Message() << std::endl;
	}

	else
	{
		auto tokens = StringHelper::split(fraction, "/");
		result = std::make_shared<Fraction>(parseInt(tokens[0]), parseInt(tokens[1]));
	}

	return *result;
}